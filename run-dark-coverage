#!/bin/bash
# run-dark-coverage - Analyze which stdlib functions are covered by E2E tests
#
# Usage: ./run-dark-coverage [OPTIONS]
#
# This performs static coverage analysis by examining which stdlib functions
# are reachable from E2E test code (call graph analysis).

set -e

# Get script directory
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
cd "$SCRIPT_DIR"

. "$SCRIPT_DIR/scripts/test-common.sh"

# Build if needed
if ! build_tests "$SCRIPT_DIR" ""; then
    exit 1
fi

# Run coverage analysis
TEST_EXE="$(find_test_exe "$SCRIPT_DIR" "")" || exit 1
run_tests "$TEST_EXE" --coverage
