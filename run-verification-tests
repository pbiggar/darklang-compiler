#!/bin/bash
# Run verification test suites for Dict and FingerTree
# These are extensive correctness tests not run by default
#
# Usage: ./run-verification-tests [OPTIONS]
#
# These tests verify:
# - Dict: Large-scale insert/retrieve, collision handling, enumeration
# - FingerTree: Index verification, push/tail operations, concat
#
# Note: Some tests may fail due to known bugs (TCO, FingerTree deep chain bug)

set -e

# Get script directory
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
cd "$SCRIPT_DIR"

. "$SCRIPT_DIR/scripts/test-common.sh"

if ! build_tests "$SCRIPT_DIR" "" "Building tests..."; then
    exit 1
fi

# Find and run the test executable
TEST_EXE="$(find_test_exe "$SCRIPT_DIR" "")" || exit 1

echo "Running verification tests..."
echo ""

run_tests "$TEST_EXE" --verification "$@"
