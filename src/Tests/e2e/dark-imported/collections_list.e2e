// Tests imported from Dark language test suite
// Source: https://raw.githubusercontent.com/darklang/dark/main/backend/testfiles/execution/language/collections/dlist.dark
//
// ALL TESTS INCLUDED - no filtering or removal
// Tests may fail if features are not yet implemented

// ===================================================================
// List literals (from Dark dlist.dark)
// NOTE: Commented out - requires Int64 suffix and Stdlib support
// ===================================================================

// NOTE: Commented out - list printing not yet supported
// [] = stdout="[]\n"

// [ 1L ] = stdout="[1]\n"

// [ 1L; 2L ] = stdout="[1, 2]\n"

// [ 5L; Stdlib.Int64.add_v0 1L 5L; 0L ] = stdout="[5, 6, 0]\n"

// ===================================================================
// Error handling tests
// NOTE: Commented out - requires Builtin.testRuntimeError/testDerrorMessage support
// ===================================================================

// [ 5L; Builtin.testRuntimeError "test"; 0L ] = Builtin.testDerrorMessage "Uncaught exception: test"

// [ 5L; Builtin.testRuntimeError "1"; Builtin.testRuntimeError "2" ] = Builtin.testDerrorMessage "Uncaught exception: 1"

// TODO mixed data attempts

// ===================================================================
// Empty list (from extended suite)
// NOTE: List printing test commented out - list printing not yet supported
// ===================================================================

// [] = stdout="[]\n"
match [] with | [] -> 1 | _ -> 0 = 1

// ===================================================================
// Single Element Lists
// NOTE: List printing tests commented out - list printing not yet supported
// ===================================================================

// [1] = stdout="[1]\n"
// [42] = stdout="[42]\n"
// [0] = stdout="[0]\n"

match [42] with | [x] -> x | _ -> 0 = 42
match [100] with | [x] -> x * 2 | _ -> 0 = 200

// ===================================================================
// Two Element Lists
// NOTE: List printing tests commented out - list printing not yet supported
// ===================================================================

// [1, 2] = stdout="[1, 2]\n"
// [10, 20] = stdout="[10, 20]\n"

match [1, 2] with | [a, b] -> a + b | _ -> 0 = 3
match [5, 10] with | [a, b] -> a * b | _ -> 0 = 50

// ===================================================================
// Three Element Lists
// NOTE: List printing tests commented out - list printing not yet supported
// ===================================================================

// [1, 2, 3] = stdout="[1, 2, 3]\n"
// [10, 20, 30] = stdout="[10, 20, 30]\n"

match [1, 2, 3] with | [a, b, c] -> a + b + c | _ -> 0 = 6
match [2, 3, 4] with | [a, b, c] -> a * b * c | _ -> 0 = 24

// ===================================================================
// Lists with Expressions
// NOTE: List printing tests commented out - list printing not yet supported
// ===================================================================

// [1 + 1, 2 + 2, 3 + 3] = stdout="[2, 4, 6]\n"
// [2 * 3, 4 * 5] = stdout="[6, 20]\n"

// let x = 5 in [x, x + 1, x + 2] = stdout="[5, 6, 7]\n"
// let a = 10 in [a, a * 2, a * 3] = stdout="[10, 20, 30]\n"

// ===================================================================
// List Pattern Matching with Wildcards
// ===================================================================

match [42, 99, 100] with | [x, _, _] -> x | _ -> 0 = 42
match [1, 2, 42] with | [_, _, x] -> x | _ -> 0 = 42
match [1, 42, 3] with | [_, x, _] -> x | _ -> 0 = 42
match [1, 2, 3] with | [_, _, _] -> 100 | _ -> 0 = 100

// ===================================================================
// List Length Matching
// ===================================================================

match [1] with | [a, b] -> a + b | _ -> 99 = 99
match [1, 2] with | [a, b, c] -> a + b + c | _ -> 99 = 99
match [1, 2, 3] with | [a, b] -> a + b | _ -> 99 = 99
match [1, 2] with | [a, b] -> a + b | _ -> 99 = 3
match [1, 2, 3] with | [a, b, c] -> a + b + c | _ -> 99 = 6

// Multiple length patterns
match [1] with | [a, b] -> 1 | [a] -> 2 | [] -> 3 | _ -> 99 = 2
match [] with | [a, b] -> 1 | [a] -> 2 | [] -> 3 = 3
match [1, 2] with | [a, b, c] -> 1 | [a, b] -> 2 | [a] -> 3 | _ -> 99 = 2

// ===================================================================
// Cons Pattern [...rest]
// ===================================================================

match [1, 2, 3] with | [h, ...t] -> h | [] -> 0 = 1
match [1, 2, 3] with | [h, ...t] -> match t with | [a, b] -> a + b | _ -> 0 | [] -> 0 = 5
match [42] with | [h, ...t] -> match t with | [] -> h | _ -> 0 | [] -> 0 = 42
match [] with | [h, ...t] -> 1 | [] -> 0 = 0
match [1, 2, 3, 4] with | [a, b, ...t] -> a + b | [] -> 0 | _ -> 0 = 3
match [1, 2, 3] with | [_, ...t] -> match t with | [a, b] -> a + b | _ -> 0 | [] -> 0 = 5
match [1, 2, 3] with | [h, ..._] -> h | [] -> 0 = 1
match [] with | [...t] -> 1 | _ -> 0 = 1
match [1] with | [...t] -> 1 | _ -> 0 = 1
match [1, 2, 3] with | [...t] -> 1 | _ -> 0 = 1

// ===================================================================
// Recursive List Functions
// NOTE: Commented out - requires generic type parameters `List<Int64>`
// ===================================================================

// def length(xs: List<Int64>) : Int64 = match xs with | [] -> 0 | [_, ...t] -> 1 + length(t) length([1, 2, 3, 4, 5]) = 5
// def sum(xs: List<Int64>) : Int64 = match xs with | [] -> 0 | [h, ...t] -> h + sum(t) sum([1, 2, 3, 4, 5]) = 15
// def length(xs: List<Int64>) : Int64 = match xs with | [] -> 0 | [_, ...t] -> 1 + length(t) length([]) = 0
// def sum(xs: List<Int64>) : Int64 = match xs with | [] -> 0 | [h, ...t] -> h + sum(t) sum([42]) = 42

// ===================================================================
// Lists in Let Bindings
// ===================================================================

let xs = [1, 2, 3] in match xs with | [a, b, c] -> a + b + c | _ -> 0 = 6
let xs = [] in match xs with | [] -> 42 | _ -> 0 = 42
let xs = [5, 10] in match xs with | [a, b] -> a * b | _ -> 0 = 50

// ===================================================================
// Nested List Matches
// ===================================================================

match [1] with | [x] -> match [x, x + 1] with | [a, b] -> a + b | _ -> 0 | _ -> 0 = 3
match [2] with | [x] -> let y = x * 3 in match [y] with | [z] -> z | _ -> 0 | _ -> 0 = 6

// ===================================================================
// Lists with Complex Bodies
// ===================================================================

match [5, 10] with | [a, b] -> if a < b then b else a | _ -> 0 = 10
match [3, 4] with | [a, b] -> let c = a * b in c + 1 | _ -> 0 = 13
match [2, 3] with | [a, b] -> let x = a + b in let y = x * 2 in y | _ -> 0 = 10

// ===================================================================
// Edge Cases
// ===================================================================

match [0, 0, 0] with | [a, b, c] -> a + b + c | _ -> 99 = 0
match [0 - 5, 0 - 10] with | [a, b] -> a + b | _ -> 0 = -15
match [1000000, 2000000] with | [a, b] -> a + b | _ -> 0 = 3000000
match [1, 2, 3, 4] with | [a, b, c, d] -> a + b + c + d | _ -> 0 = 10
match [1, 2, 3, 4, 5] with | [a, b, c, d, e] -> a + b + c + d + e | _ -> 0 = 15
