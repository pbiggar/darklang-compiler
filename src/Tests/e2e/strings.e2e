// String Literals E2E Tests
//
// Tests for string literal parsing, type checking, and printing

// Basic string literal printing
"hello" = stdout="hello\n"
"world" = stdout="world\n"
"test" = stdout="test\n"

// Empty string (just newline output)
"" = stdout="\n"

// String with spaces
"hello world" = stdout="hello world\n"
"a b c" = stdout="a b c\n"

// Single characters
"a" = stdout="a\n"
"Z" = stdout="Z\n"
"0" = stdout="0\n"

// Escape sequences - newline
"hello\nworld" = stdout="hello\nworld\n"

// Escape sequences - tab
"a\tb" = stdout="a\tb\n"

// Escape sequences - quote
"say \"hi\"" = stdout="say \"hi\"\n"

// Escape sequences - backslash
"a\\b" = stdout="a\\b\n"

// Multiple newlines
"a\nb\nc" = stdout="a\nb\nc\n"

// =============================================================================
// String Concatenation Tests (++ operator)
// =============================================================================

// Basic concatenation
"hello" ++ " world" = stdout="hello world\n"
"a" ++ "b" = stdout="ab\n"
"foo" ++ "bar" = stdout="foobar\n"

// Empty string concatenation
"" ++ "test" = stdout="test\n"
"test" ++ "" = stdout="test\n"
"" ++ "" = stdout="\n"

// Chained concatenation (left associative)
"a" ++ "b" ++ "c" = stdout="abc\n"
"hello" ++ " " ++ "world" = stdout="hello world\n"

// Variables with concatenation
let x = "hello" in x ++ " world" = stdout="hello world\n"
let x = "a" in let y = "b" in x ++ y = stdout="ab\n"

// Chained concatenation with multiple variables (regression test for known bug)
let x = "one" in let y = "two" in x ++ " and " ++ y = stdout="one and two\n"
let a = "hello" in let b = "world" in let c = "!" in a ++ " " ++ b ++ c = stdout="hello world!\n"

// Concatenation in let binding
let result = "foo" ++ "bar" in result = stdout="foobar\n"

// Longer strings
"this is a" ++ " longer test" = stdout="this is a longer test\n"

// Single character concatenation
"a" ++ "b" ++ "c" ++ "d" = stdout="abcd\n"

// =============================================================================
// Int64.toString Tests
// =============================================================================

// Single digit conversion
Stdlib.Int64.digitToString(0) = stdout="0\n"
Stdlib.Int64.digitToString(5) = stdout="5\n"
Stdlib.Int64.digitToString(9) = stdout="9\n"

// Basic integer to string
Stdlib.Int64.toString(0) = stdout="0\n"
Stdlib.Int64.toString(1) = stdout="1\n"
Stdlib.Int64.toString(9) = stdout="9\n"
Stdlib.Int64.toString(10) = stdout="10\n"
Stdlib.Int64.toString(42) = stdout="42\n"
Stdlib.Int64.toString(100) = stdout="100\n"
Stdlib.Int64.toString(999) = stdout="999\n"
Stdlib.Int64.toString(1234) = stdout="1234\n"
Stdlib.Int64.toString(12345) = stdout="12345\n"

// Negative numbers
Stdlib.Int64.toString(-1) = stdout="-1\n"
Stdlib.Int64.toString(-42) = stdout="-42\n"
Stdlib.Int64.toString(-100) = stdout="-100\n"
Stdlib.Int64.toString(-12345) = stdout="-12345\n"

// Large numbers
Stdlib.Int64.toString(1000000) = stdout="1000000\n"
Stdlib.Int64.toString(2147483647) = stdout="2147483647\n"

// Concatenation with toString
"Value: " ++ Stdlib.Int64.toString(42) = stdout="Value: 42\n"
"Answer is " ++ Stdlib.Int64.toString(42) ++ "!" = stdout="Answer is 42!\n"

// =============================================================================
// Bool.toString Tests
// =============================================================================

Stdlib.Bool.toString(true) = stdout="true\n"
Stdlib.Bool.toString(false) = stdout="false\n"
"The answer is " ++ Stdlib.Bool.toString(true) = stdout="The answer is true\n"
"Flag: " ++ Stdlib.Bool.toString(1 > 0) = stdout="Flag: true\n"

// =============================================================================
// String Interpolation Tests
// =============================================================================

// Basic interpolation with string variable
let name = "Alice" in $"Hello {name}" = stdout="Hello Alice\n"

// Just interpolation (no literal parts)
let name = "Dave" in $"{name}" = stdout="Dave\n"

// Escape sequences in interpolated strings
$"Hello\nWorld" = stdout="Hello\nWorld\n"
$"Tab\there" = stdout="Tab\there\n"

// No interpolation (just like regular string)
$"plain string" = stdout="plain string\n"

// Empty interpolated string
$"" = stdout="\n"

// Interpolation with string literals
$"{"hello"}" = stdout="hello\n"
$"Say: {"hi"}" = stdout="Say: hi\n"

// Expression with operators (string concat inside interpolation)
$"{"a" ++ "b"}" = stdout="ab\n"

// NOTE: Multiple interpolations like $"{x} and {y}" trigger a pre-existing bug
// in chained string concatenation code generation - to be fixed separately

// =============================================================================
// Stdlib.String.getByteAt Tests
// =============================================================================

// Get bytes from ASCII string "abc" = 97, 98, 99
Stdlib.String.getByteAt("abc", 0) = 97
Stdlib.String.getByteAt("abc", 1) = 98
Stdlib.String.getByteAt("abc", 2) = 99

// Get bytes from uppercase "ABC" = 65, 66, 67
Stdlib.String.getByteAt("ABC", 0) = 65
Stdlib.String.getByteAt("ABC", 1) = 66
Stdlib.String.getByteAt("ABC", 2) = 67

// Get byte from single character
Stdlib.String.getByteAt("x", 0) = 120

// Get space character (ASCII 32)
Stdlib.String.getByteAt(" ", 0) = 32

// Get digits
Stdlib.String.getByteAt("0", 0) = 48
Stdlib.String.getByteAt("9", 0) = 57

// Helper functions for character type checks
Stdlib.String.__isLowercase(97) = stdout="true\n"
Stdlib.String.__isLowercase(122) = stdout="true\n"
Stdlib.String.__isLowercase(65) = stdout="false\n"
Stdlib.String.__isUppercase(65) = stdout="true\n"
Stdlib.String.__isUppercase(90) = stdout="true\n"
Stdlib.String.__isUppercase(97) = stdout="false\n"

// =============================================================================
// Stdlib.String.startsWith Tests
// =============================================================================

// Basic startsWith
Stdlib.String.startsWith("hello world", "hello") = stdout="true\n"
Stdlib.String.startsWith("hello world", "world") = stdout="false\n"
Stdlib.String.startsWith("abc", "a") = stdout="true\n"
Stdlib.String.startsWith("abc", "ab") = stdout="true\n"
Stdlib.String.startsWith("abc", "abc") = stdout="true\n"
Stdlib.String.startsWith("abc", "abcd") = stdout="false\n"

// Empty string cases
Stdlib.String.startsWith("hello", "") = stdout="true\n"
Stdlib.String.startsWith("", "") = stdout="true\n"
Stdlib.String.startsWith("", "a") = stdout="false\n"

// =============================================================================
// Stdlib.String.endsWith Tests
// =============================================================================

// Basic endsWith
Stdlib.String.endsWith("hello world", "world") = stdout="true\n"
Stdlib.String.endsWith("hello world", "hello") = stdout="false\n"
Stdlib.String.endsWith("abc", "c") = stdout="true\n"
Stdlib.String.endsWith("abc", "bc") = stdout="true\n"
Stdlib.String.endsWith("abc", "abc") = stdout="true\n"
Stdlib.String.endsWith("abc", "xabc") = stdout="false\n"

// Empty string cases
Stdlib.String.endsWith("hello", "") = stdout="true\n"
Stdlib.String.endsWith("", "") = stdout="true\n"
Stdlib.String.endsWith("", "a") = stdout="false\n"

// =============================================================================
// Stdlib.String.indexOf Tests
// =============================================================================

// Basic indexOf
Stdlib.String.indexOf("hello world", "hello") = 0
Stdlib.String.indexOf("hello world", "world") = 6
Stdlib.String.indexOf("hello world", "o") = 4
Stdlib.String.indexOf("hello world", "o w") = 4

// Not found
Stdlib.String.indexOf("hello world", "xyz") = -1
Stdlib.String.indexOf("abc", "d") = -1

// Empty string search
Stdlib.String.indexOf("hello", "") = 0
Stdlib.String.indexOf("", "") = 0

// =============================================================================
// Stdlib.String.contains Tests
// =============================================================================

// Basic contains
Stdlib.String.contains("hello world", "hello") = stdout="true\n"
Stdlib.String.contains("hello world", "world") = stdout="true\n"
Stdlib.String.contains("hello world", "o w") = stdout="true\n"
Stdlib.String.contains("hello world", "xyz") = stdout="false\n"

// Empty string cases
Stdlib.String.contains("hello", "") = stdout="true\n"
Stdlib.String.contains("", "") = stdout="true\n"
Stdlib.String.contains("", "a") = stdout="false\n"

// =============================================================================
// Stdlib.String.slice Tests
// =============================================================================

// Basic slice
Stdlib.String.slice("hello world", 0, 5) = stdout="hello\n"
Stdlib.String.slice("hello world", 6, 5) = stdout="world\n"
Stdlib.String.slice("hello world", 0, 11) = stdout="hello world\n"

// Slice from middle
Stdlib.String.slice("abcdef", 2, 3) = stdout="cde\n"

// Empty result
Stdlib.String.slice("hello", 0, 0) = stdout="\n"
Stdlib.String.slice("hello", 5, 0) = stdout="\n"

// Clamping behavior
Stdlib.String.slice("hello", 0, 100) = stdout="hello\n"
Stdlib.String.slice("hello", 10, 5) = stdout="\n"

// =============================================================================
// Stdlib.String.take and drop Tests
// =============================================================================

// take
Stdlib.String.take("hello world", 5) = stdout="hello\n"
Stdlib.String.take("hello", 0) = stdout="\n"
Stdlib.String.take("hello", 100) = stdout="hello\n"

// drop
Stdlib.String.drop("hello world", 6) = stdout="world\n"
Stdlib.String.drop("hello", 0) = stdout="hello\n"
Stdlib.String.drop("hello", 100) = stdout="\n"

// =============================================================================
// Stdlib.String.substring Tests
// =============================================================================

Stdlib.String.substring("hello world", 0, 5) = stdout="hello\n"
Stdlib.String.substring("hello world", 6, 11) = stdout="world\n"
